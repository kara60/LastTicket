<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - SoftDesk</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Alpine.js for interactions -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'display': ['Inter', 'ui-sans-serif', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a'
                        },
                        gray: {
                            50: '#f9fafb',
                            100: '#f3f4f6',
                            200: '#e5e7eb',
                            300: '#d1d5db',
                            400: '#9ca3af',
                            500: '#6b7280',
                            600: '#4b5563',
                            700: '#374151',
                            800: '#1f2937',
                            900: '#111827'
                        }
                    },
                    animation: {
                        'slide-in': 'slideIn 0.3s ease-out',
                        'fade-in': 'fadeIn 0.2s ease-in-out',
                        'scale-in': 'scaleIn 0.2s ease-out'
                    },
                    keyframes: {
                        slideIn: {
                            '0%': { transform: 'translateX(-100%)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' }
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.95)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>

    <!-- jQuery - Toastr için gerekli -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- Toastr CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.8);
        }

        .sidebar-transition {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .content-transition {
            transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .notification-badge {
            animation: pulse 2s infinite;
        }

        /* Compact sidebar styles */
        .sidebar-compact .nav-item {
            justify-content: center;
            padding: 0.75rem;
        }

        .sidebar-compact .nav-icon {
            margin: 0;
        }

        /* TOASTR CUSTOM STYLES - Güçlü CSS Selectors */
        #toast-container {
            position: fixed !important;
            top: 20px !important;
            right: 20px !important;
            z-index: 999999 !important;
            pointer-events: none !important;
        }

            #toast-container > div {
                pointer-events: auto !important;
                margin-bottom: 15px !important;
                border-radius: 12px !important;
                padding: 18px 24px !important;
                min-width: 350px !important;
                max-width: 420px !important;
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important;
                font-size: 14px !important;
                font-weight: 500 !important;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05) !important;
                border: none !important;
                backdrop-filter: blur(10px) !important;
            }

            /* Toast Success */
            #toast-container > .toast-success {
                background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
                color: white !important;
                border-left: 5px solid #065f46 !important;
            }

            /* Toast Error */
            #toast-container > .toast-error {
                background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important;
                color: white !important;
                border-left: 5px solid #991b1b !important;
            }

            /* Toast Warning */
            #toast-container > .toast-warning {
                background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
                color: white !important;
                border-left: 5px solid #92400e !important;
            }

            /* Toast Info */
            #toast-container > .toast-info {
                background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important;
                color: white !important;
                border-left: 5px solid #1d4ed8 !important;
            }

            /* Toast Title */
            #toast-container > div .toast-title {
                font-weight: 600 !important;
                font-size: 15px !important;
                margin-bottom: 6px !important;
                color: white !important;
                text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
            }

            /* Toast Message */
            #toast-container > div .toast-message {
                font-size: 14px !important;
                line-height: 1.5 !important;
                color: rgba(255, 255, 255, 0.95) !important;
                margin: 0 !important;
            }

            /* Close Button */
            #toast-container > div .toast-close-button {
                position: relative !important;
                right: 0 !important;
                top: 0 !important;
                background: rgba(255, 255, 255, 0.2) !important;
                color: white !important;
                font-size: 16px !important;
                font-weight: bold !important;
                width: 22px !important;
                height: 22px !important;
                border-radius: 50% !important;
                text-align: center !important;
                line-height: 20px !important;
                float: right !important;
                margin-left: 15px !important;
                margin-top: -2px !important;
                opacity: 0.8 !important;
                transition: all 0.2s ease !important;
            }

                #toast-container > div .toast-close-button:hover {
                    background: rgba(255, 255, 255, 0.3) !important;
                    opacity: 1 !important;
                    transform: scale(1.1) !important;
                }

            /* Progress Bar */
            #toast-container > div .toast-progress {
                position: absolute !important;
                left: 0 !important;
                bottom: 0 !important;
                height: 4px !important;
                background: rgba(255, 255, 255, 0.7) !important;
                border-radius: 0 0 12px 12px !important;
                opacity: 0.8 !important;
            }

            /* Animation */
            #toast-container > div {
                animation: slideInRight 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
            }

        @@keyframes slideInRight {
            from

        {
            opacity: 0;
            transform: translateX(100%) scale(0.8);
        }

        to {
            opacity: 1;
            transform: translateX(0) scale(1);
        }

        }

        /* Mobile Responsive */
        @@media (max-width: 768px) {
            #toast-container

        {
            top: 10px !important;
            right: 10px !important;
            left: 10px !important;
        }

        #toast-container > div {
            min-width: auto !important;
            max-width: 100% !important;
            margin-left: 0 !important;
            margin-right: 0 !important;
        }

        }

        /* Icon for different toast types */
        #toast-container > .toast-success:before {
            content: "✓";
            font-size: 18px;
            font-weight: bold;
            margin-right: 10px;
            opacity: 0.9;
        }

        #toast-container > .toast-error:before {
            content: "✗";
            font-size: 18px;
            font-weight: bold;
            margin-right: 10px;
            opacity: 0.9;
        }

        #toast-container > .toast-warning:before {
            content: "⚠";
            font-size: 18px;
            margin-right: 10px;
            opacity: 0.9;
        }

        #toast-container > .toast-info:before {
            content: "ℹ";
            font-size: 18px;
            font-weight: bold;
            margin-right: 10px;
            opacity: 0.9;
        }

        /* Sidebar Scroll Styling */
        .scrollbar-thin {
            scrollbar-width: thin;
        }

        .scrollbar-thumb-gray-300::-webkit-scrollbar-thumb {
            background-color: rgb(209 213 219);
            border-radius: 6px;
        }

        .scrollbar-track-gray-100::-webkit-scrollbar-track {
            background-color: rgb(243 244 246);
        }

        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }

        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: rgb(209 213 219);
            border-radius: 6px;
        }

        .scrollbar-thin::-webkit-scrollbar-track {
            background-color: rgb(243 244 246);
        }

        /* Sidebar Navigation Enhancement */
        .nav-item-hover {
            position: relative;
        }

            .nav-item-hover:hover {
                transform: translateX(2px);
                background: rgba(59, 130, 246, 0.08);
            }

                .nav-item-hover:hover::before {
                    content: '';
                    position: absolute;
                    left: 0;
                    top: 0;
                    bottom: 0;
                    width: 3px;
                    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
                    border-radius: 0 3px 3px 0;
                }

        /* User Profile Fixed Position */
        .user-profile-section {
            position: sticky;
            bottom: 0;
            background: white;
            border-top: 1px solid rgb(229 231 235);
        }

        /* Sidebar Responsive Height */
        #sidebar {
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 50;
        }

        /* Content margin adjustment */
        .content-with-sidebar {
            transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Mobile overlay for sidebar */
        @@media (max-width: 768px) {
            #sidebar

        {
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        #sidebar.mobile-open {
            transform: translateX(0);
        }

        .content-with-sidebar {
            margin-left: 0 !important;
        }

        }

        /* DÜZELTME: z-index problemi */
        #sidebar {
            z-index: 40 !important; /* Toast'tan düşük olmalı */
        }

        /* Mobile sidebar overlay */
        .mobile-overlay {
            z-index: 30 !important; /* sidebar'dan düşük */
        }
    </style>
</head>
<body class="bg-gray-50 font-display" x-data="{ sidebarOpen: true, showProfileMenu: false }">
    <!-- Sidebar -->
    <div id="sidebar"
         :class="sidebarOpen ? 'w-64' : 'w-16'"
         class="sidebar-transition bg-white shadow-lg border-r border-gray-200 h-screen fixed left-0 top-0 flex flex-col">

        <!-- Logo Section - SABIT ÜST -->
        <div class="p-3 border-b border-gray-200 flex-shrink-0">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3" :class="!sidebarOpen && 'justify-center'">
                    <div class="w-9 h-9 bg-gradient-to-r from-primary-500 to-primary-600 rounded-lg flex items-center justify-center shadow-md">
                        <i class="fas fa-ticket-alt text-white text-sm"></i>
                    </div>
                    <div x-show="sidebarOpen" x-transition class="flex flex-col">
                        <h1 class="text-lg font-bold text-gray-900">SoftDesk</h1>
                        <p class="text-xs text-gray-500">v2.0</p>
                    </div>
                </div>
                <button @@click="sidebarOpen = !sidebarOpen"
                        class="p-1.5 rounded-md hover:bg-gray-100 transition-colors duration-200">
                    <i :class="sidebarOpen ? 'fa-chevron-left' : 'fa-chevron-right'"
                       class="fas text-gray-600 text-xs transition-transform duration-200"></i>
                </button>
            </div>
        </div>

        <!-- Navigation - ESNEKLİK VE SCROLL -->
        <nav class="flex-1 p-3 space-y-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100">
            @if (User.IsInRole("Admin"))
            {
                <!-- Dashboard -->
                <a href="@Url.Action("Index", "Dashboard", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Dashboard" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-tachometer-alt w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Dashboard</span>
                </a>

                <!-- Tickets -->
                <a href="@Url.Action("Index", "Tickets", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Tickets" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-ticket-alt w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Tüm Ticket'lar</span>
                    <span x-show="sidebarOpen" x-transition class="ml-auto bg-red-100 text-red-600 text-xs px-1.5 py-0.5 rounded-full notification-badge">12</span>
                </a>

                <!-- Management Section -->
                <div x-show="sidebarOpen" x-transition class="pt-3">
                    <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2 px-2">Genel</h3>
                </div>

                <a href="@Url.Action("Index", "TicketTypes", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "TicketTypes" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-cog w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Ticket Türleri</span>
                </a>

                <a href="@Url.Action("Index", "Categories", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Categories" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-folder w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Kategoriler</span>
                </a>

                <a href="@Url.Action("Index", "Customers", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Customers" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-building w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Müşteriler</span>
                </a>

                <a href="@Url.Action("Index", "Users", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Users" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-users w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Kullanıcılar</span>
                </a>

                <!-- System Section -->
                <div x-show="sidebarOpen" x-transition class="pt-3">
                    <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2 px-2">Sistem</h3>
                </div>

                <a href="@Url.Action("Index", "SystemSettings", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "SystemSettings" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-server w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Sistem Ayarları</span>
                </a>

                <a href="@Url.Action("Index", "Reports", new { area = "Admin" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Reports" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-chart-bar w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Raporlar</span>
                </a>
            }
            else
            {
                <!-- Customer Navigation -->
                <a href="@Url.Action("Index", "Dashboard", new { area = "Customer" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Dashboard" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-tachometer-alt w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Dashboard</span>
                </a>

                <a href="@Url.Action("Index", "Tickets", new { area = "Customer" })"
                   class="nav-item-hover flex items-center p-2.5 rounded-lg transition-all duration-200 @(ViewContext.RouteData.Values["controller"]?.ToString() == "Tickets" ? "bg-primary-50 text-primary-700 border-l-2 border-primary-500" : "text-gray-700 hover:text-primary-600")"
                   :class="!sidebarOpen && 'justify-center'">
                    <i class="fas fa-ticket-alt w-4 flex-shrink-0 nav-icon" :class="sidebarOpen && 'mr-3'"></i>
                    <span x-show="sidebarOpen" x-transition class="font-medium text-sm">Ticket'larım</span>
                    <span x-show="sidebarOpen" x-transition class="ml-auto bg-blue-100 text-blue-600 text-xs px-1.5 py-0.5 rounded-full">3</span>
                </a>
            }
        </nav>

        <!-- User Profile Section - SABIT ALT -->
        <div class="p-3 border-t border-gray-200 flex-shrink-0 bg-white">
            <div class="relative" x-data="{ showMenu: false }">
                <button @@click="showMenu = !showMenu"
                        class="w-full flex items-center space-x-2 p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200"
                        :class="!sidebarOpen && 'justify-center'">
                    <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white font-medium text-xs">
                            @(User.FindFirst(System.Security.Claims.ClaimTypes.GivenName)?.Value?.Substring(0, 1) ?? "U")@(User.FindFirst(System.Security.Claims.ClaimTypes.Surname)?.Value?.Substring(0, 1) ?? "")
                        </span>
                    </div>
                    <div x-show="sidebarOpen" x-transition class="flex-1 text-left min-w-0">
                        <p class="font-medium text-gray-900 text-sm truncate">@User.FindFirst(System.Security.Claims.ClaimTypes.GivenName)?.Value @User.FindFirst(System.Security.Claims.ClaimTypes.Surname)?.Value</p>
                        <p class="text-xs text-gray-500">@User.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value</p>
                    </div>
                    <i x-show="sidebarOpen" x-transition class="fas fa-chevron-down text-gray-400 text-xs transition-transform duration-200 flex-shrink-0"
                       :class="showMenu && 'rotate-180'"></i>
                </button>

                <!-- Profile Dropdown -->
                <div x-show="showMenu"
                     x-transition:enter="transition ease-out duration-200"
                     x-transition:enter-start="opacity-0 scale-95"
                     x-transition:enter-end="opacity-1 scale-100"
                     x-transition:leave="transition ease-in duration-150"
                     x-transition:leave-start="opacity-1 scale-100"
                     x-transition:leave-end="opacity-0 scale-95"
                     class="absolute bottom-full left-0 right-0 mb-2 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50">
                    <a href="@Url.Action("Profile", "Account")" class="w-full flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                        <i class="fas fa-user mr-2 text-xs"></i>Profil
                    </a>
                    <a href="@Url.Action("Settings", "Account")" class="w-full flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                        <i class="fas fa-cog mr-2 text-xs"></i>Ayarlar
                    </a>
                    <hr class="my-1">
                    <form method="post" asp-area="" asp-controller="Auth" asp-action="Logout" class="block">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="w-full flex items-center px-3 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-200">
                            <i class="fas fa-sign-out-alt mr-2 text-xs"></i>Çıkış Yap
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Ana içerik için margin eklemesi -->
    <div class="transition-all duration-300" :class="sidebarOpen ? 'ml-64' : 'ml-16'">
        <!-- Main Content -->
        <div class="flex-1 flex flex-col min-h-screen">
            <!-- Top Header -->
            <header class="bg-white shadow-sm border-b border-gray-200 px-4 py-3 flex-shrink-0">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4 min-w-0 flex-1">
                        <h1 class="text-xl font-bold text-gray-900 truncate">@ViewData["Title"]</h1>
                    </div>

                    <div class="flex items-center space-x-3 flex-shrink-0">
                        <!-- Quick Actions -->
                        <div class="hidden md:flex items-center">
                            @if (User.IsInRole("Customer"))
                            {
                                <a href="@Url.Action("Create", "Tickets", new { area = "Customer" })"
                                   class="bg-primary-500 hover:bg-primary-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center space-x-2">
                                    <i class="fas fa-plus text-xs"></i>
                                    <span>Yeni Ticket Oluştur</span>
                                </a>
                            }
                        </div>

                        <!-- Notifications -->
                        <div class="relative" x-data="{ show: false }">
                            <button @@click="show = !show" class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200 relative">
                                <i class="fas fa-bell text-lg"></i>
                                <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"></span>
                            </button>

                            <!-- Notification Dropdown -->
                            <div x-show="show"
                                 @@click.away="show = false"
                                 x-transition:enter="transition ease-out duration-200"
                                 x-transition:enter-start="opacity-0 scale-95"
                                 x-transition:enter-end="opacity-1 scale-100"
                                 x-transition:leave="transition ease-in duration-150"
                                 x-transition:leave-start="opacity-1 scale-100"
                                 x-transition:leave-end="opacity-0 scale-95"
                                 class="absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-200 z-50">
                                <div class="p-4 border-b border-gray-200">
                                    <h3 class="font-semibold text-gray-900">Bildirimler</h3>
                                </div>
                                <div class="max-h-96 overflow-y-auto">
                                    <div class="p-4 hover:bg-gray-50 border-b border-gray-100">
                                        <div class="flex items-start space-x-3">
                                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                                <i class="fas fa-ticket-alt text-blue-600 text-xs"></i>
                                            </div>
                                            <div class="flex-1">
                                                <p class="text-sm font-medium text-gray-900">Yeni ticket oluşturuldu</p>
                                                <p class="text-xs text-gray-500 mt-1">ABC Teknoloji'den #TK2024001</p>
                                                <p class="text-xs text-gray-400 mt-1">5 dakika önce</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="p-4 text-center text-gray-500 text-sm">
                                        Tüm bildirimler görüntülendi
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="hidden lg:flex items-center space-x-2 text-sm text-gray-500">
                            <i class="fas fa-calendar-alt text-xs"></i>
                            <span class="whitespace-nowrap">@DateTime.Now.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR"))</span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 p-4 bg-gray-50 overflow-y-auto">
                <!-- Page Content -->
                <div class="animate-scale-in">
                    @RenderBody()
                </div>
            </main>
        </div>
    </div>

    <!-- Mobile Overlay -->
    <div x-show="sidebarOpen && window.innerWidth < 768"
         x-transition:enter="transition-opacity ease-linear duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition-opacity ease-linear duration-300"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @@click="sidebarOpen = false"
         class="fixed inset-0 bg-gray-600 bg-opacity-75 mobile-overlay md:hidden"></div>

    <!-- Scripts -->
    <script>
        // Mobile responsiveness
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 768) {
                // Reset sidebar state on desktop
                // Sidebar'ı masaüstünde her zaman açık tut
                if (window.Alpine && window.Alpine.store) {
                    window.Alpine.store('sidebarOpen', true);
                }
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl + B to toggle sidebar
            if (e.ctrlKey && e.key === 'b') {
                e.preventDefault();
                // Toggle sidebar using Alpine
                if (window.Alpine) {
                    const sidebarState = document.querySelector('[x-data]').__x.$data.sidebarOpen;
                    document.querySelector('[x-data]').__x.$data.sidebarOpen = !sidebarState;
                }
            }
        });

        // Loading states for forms
        document.addEventListener('DOMContentLoaded', function() {
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                form.addEventListener('submit', function() {
                    const submitBtn = form.querySelector('button[type="submit"]');
                    if (submitBtn && !submitBtn.disabled) {
                        const originalContent = submitBtn.innerHTML;
                        submitBtn.disabled = true;
                        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>İşleniyor...';

                        // Reset after 10 seconds if no response
                        setTimeout(() => {
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = originalContent;
                        }, 10000);
                    }
                });
            });

            // Mobile sidebar behavior
            const sidebar = document.getElementById('sidebar');
            if (window.innerWidth < 768) {
                // Mobile'da sidebar kapalı başlasın
                document.querySelector('[x-data]').__x.$data.sidebarOpen = false;
            }
        });

        // Confirm logout
        function confirmLogout() {
            return confirm('Çıkış yapmak istediğinizden emin misiniz?');
        }

        // Add confirm to logout forms
        document.addEventListener('DOMContentLoaded', function() {
            const logoutForms = document.querySelectorAll('form[action*="Logout"]');
            logoutForms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    if (!confirmLogout()) {
                        e.preventDefault();
                    }
                });
            });
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)

    <!-- Toastr JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <script>
        // jQuery yüklü mü kontrol et
        if (typeof jQuery === 'undefined') {
            console.error('jQuery bulunamadı! Toastr çalışmayacak.');
        } else {
            console.log('jQuery yüklendi, Toastr hazırlanıyor...');

            // Toastr konfigürasyonu - Daha gelişmiş ayarlar
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": true,
                "onclick": null,
                "showDuration": "400",
                "hideDuration": "600",
                "timeOut": "6000",
                "extendedTimeOut": "2000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut",
                "tapToDismiss": true
            };

            // TempData'dan gelen mesajları otomatik göster
            @if (TempData["Success"] != null)
            {
                    <text>toastr.success('@Html.Raw(TempData["Success"].ToString().Replace("'", "\\'").Replace("\n", "\\n").Replace("\r", ""))');</text>
            }

            @if (TempData["Error"] != null)
            {
                    <text>toastr.error('@Html.Raw(TempData["Error"].ToString().Replace("'", "\\'").Replace("\n", "\\n").Replace("\r", ""))');</text>
            }

            @if (TempData["Warning"] != null)
            {
                    <text>toastr.warning('@Html.Raw(TempData["Warning"].ToString().Replace("'", "\\'").Replace("\n", "\\n").Replace("\r", ""))');</text>
            }

            @if (TempData["Info"] != null)
            {
                    <text>toastr.info('@Html.Raw(TempData["Info"].ToString().Replace("'", "\\'").Replace("\n", "\\n").Replace("\r", ""))');</text>
            }

            // Manuel toast fonksiyonları (JavaScript'ten çağırmak için)
            window.showToast = function(type, message, title) {
                switch(type) {
                    case 'success':
                        toastr.success(message, title);
                        break;
                    case 'error':
                        toastr.error(message, title);
                        break;
                    case 'warning':
                        toastr.warning(message, title);
                        break;
                    case 'info':
                        toastr.info(message, title);
                        break;
                    default:
                        toastr.info(message, title);
                }
            };

            // Ticket özel fonksiyonları
            window.showTicketToast = function(action, ticketNumber, additionalInfo) {
                switch(action) {
                    case 'created':
                        toastr.success(`Ticket ${ticketNumber} başarıyla oluşturuldu!`, 'Ticket Oluşturuldu');
                        break;
                    case 'updated':
                        toastr.info(`Ticket ${ticketNumber} güncellendi.`, 'Ticket Güncellendi');
                        break;
                    case 'status_changed':
                        toastr.warning(`Ticket ${ticketNumber} durumu "${additionalInfo}" olarak değiştirildi.`, 'Durum Değişikliği');
                        break;
                    case 'commented':
                        toastr.info(`Ticket ${ticketNumber}'e yeni yorum eklendi.`, 'Yeni Yorum');
                        break;
                    case 'assigned':
                        toastr.info(`Ticket ${ticketNumber} size atandı.`, 'Ticket Atandı');
                        break;
                }
            };
        }
    </script>
</body>
</html>